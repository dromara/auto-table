---
title: æ•°æ®åˆå§‹åŒ–
description: AutoTable è‡ªåŠ¨åˆå§‹åŒ–æ•°æ®
---

# æ•°æ®åˆå§‹åŒ–

åœ¨è‡ªåŠ¨åˆ›å»ºå®Œè¡¨æ ¼åï¼Œç³»ç»Ÿé€šå¸¸éœ€è¦åˆå§‹åŒ–æ•°æ®ï¼Œæ¯”å¦‚ç”¨æˆ·è¡¨ã€æƒé™è¡¨ç­‰ã€‚

## ä¸‰ç§åˆå§‹åŒ–æ–¹å¼

```mermaid
flowchart TB
    subgraph methods["ğŸ“¦ æ•°æ®åˆå§‹åŒ–æ–¹å¼"]
        direction TB
        
        subgraph m1["âœˆï¸ æ–¹å¼ä¸€"]
            M1_DESC["è‡ªåŠ¨åŒ¹é…SQLè„šæœ¬"]
        end
        
        subgraph m2["ğŸš„ æ–¹å¼äºŒ"]
            M2_DESC["æ‰‹åŠ¨æŒ‡å®šSQLè„šæœ¬"]
        end
        
        subgraph m3["ğŸš¤ æ–¹å¼ä¸‰"]
            M3_DESC["Javaæ–¹æ³•è¿”å›æ•°æ®"]
        end
    end

    style m1 fill:#dbeafe,stroke:#3b82f6
    style m2 fill:#d1fae5,stroke:#10b981
    style m3 fill:#fef3c7,stroke:#f59e0b
```

## æ–¹å¼ä¸€ï¼šè‡ªåŠ¨åŒ¹é… SQL è„šæœ¬

```mermaid
flowchart LR
    subgraph entity["å®ä½“ç±»"]
        E["User.java"]
    end
    
    AT["AutoTable è‡ªåŠ¨åŒ¹é…"]
    
    subgraph sql["SQL è„šæœ¬"]
        S["sql/user.sql"]
    end
    
    subgraph db["æ•°æ®åº“"]
        D[("user è¡¨")]
    end
    
    entity --> AT
    AT --> sql
    sql --> db

    style AT fill:#6366f1,stroke:#4f46e5,color:#fff
```

> é…ç½®é¡¹ï¼š[auto-table.init-data](/APIå‚è€ƒ/é…ç½®é¡¹#init-data)

### å•æ•°æ®æºåœºæ™¯

ç³»ç»Ÿé»˜è®¤è¯»å– `classpath:sql` ç›®å½•ä¸‹çš„è„šæœ¬ï¼Œåªä¼šåœ¨ç›¸å…³è¡¨åˆ›å»ºå®Œæˆæ—¶æ‰§è¡Œä¸€æ¬¡ã€‚

```
src/main/resources/
â””â”€â”€ sql/
    â”œâ”€â”€ user.sql          # user è¡¨åˆå§‹åŒ–æ•°æ®
    â”œâ”€â”€ role.sql          # role è¡¨åˆå§‹åŒ–æ•°æ®
    â””â”€â”€ _init_.sql        # æ‰€æœ‰è¡¨åˆ›å»ºå®Œæˆåæ‰§è¡Œ
```

::: tip é…ç½®é¡¹
- `base-path`ï¼šä¿®æ”¹è„šæœ¬æ ¹ç›®å½•ï¼Œé»˜è®¤ `classpath:sql`
- `default-init-file-name`ï¼šä¿®æ”¹å…¨å±€åˆå§‹åŒ–æ–‡ä»¶åï¼Œé»˜è®¤ `_init_`
:::

### å¤šæ•°æ®æºåœºæ™¯

```mermaid
flowchart TB
    subgraph structure["ğŸ“ ç›®å½•ç»“æ„"]
        direction TB
        ROOT["sql/"]
        DS1["datasource1/"]
        DS2["datasource2/"]
        
        ROOT --> DS1
        ROOT --> DS2
        
        DS1 --> F1["user.sql"]
        DS1 --> F2["_init_.sql"]
        DS2 --> F3["order.sql"]
        DS2 --> F4["_init_.sql"]
    end

    style structure fill:#f0f9ff,stroke:#0ea5e9
```

```
src/main/resources/
â””â”€â”€ sql/
    â”œâ”€â”€ datasource1/
    â”‚   â”œâ”€â”€ user.sql           # datasource1 çš„ user è¡¨
    â”‚   â””â”€â”€ _init_.sql         # datasource1 æ•´åº“åˆå§‹åŒ–
    â””â”€â”€ datasource2/
        â”œâ”€â”€ order.sql          # datasource2 çš„ order è¡¨
        â””â”€â”€ _init_.sql         # datasource2 æ•´åº“åˆå§‹åŒ–
```

## æ–¹å¼äºŒï¼šæ‰‹åŠ¨æŒ‡å®š SQL è„šæœ¬

é€šè¿‡ `@AutoTable` çš„ `initSql` å±æ€§æŒ‡å®š SQL è„šæœ¬ä½ç½®ã€‚

```mermaid
flowchart LR
    A["@AutoTable initSql"] --> B["SQLè„šæœ¬"]
    B --> C[("æ•°æ®åº“")]

    style A fill:#10b981,stroke:#059669,color:#fff
```

```java
@AutoTable(
    comment = "è‡ªå®šä¹‰sqlæ–‡ä»¶åˆå§‹åŒ–æ•°æ®", 
    initSql = "classpath:customize_path/InitData.sql"
)
public class InitDataCustomizeFile {
    private String name;
}
```

### å¤šåº“é€‚é…

`initSql` æ”¯æŒ `{dialect}` å ä½ç¬¦ï¼Œè‡ªåŠ¨åŒ¹é…å½“å‰æ•°æ®åº“ç±»å‹ï¼š

```java
@AutoTable(initSql = "classpath:sql/{dialect}/user.sql")
public class User {
    // ...
}
```

```mermaid
flowchart LR
    subgraph template["æ¨¡æ¿"]
        T["sql/{dialect}/user.sql"]
    end
    
    subgraph actual["å®é™…æ–‡ä»¶"]
        A1["MySQL/user.sql"]
        A2["Oracle/user.sql"]
        A3["PostgreSQL/user.sql"]
    end
    
    template --> actual

    style template fill:#6366f1,stroke:#4f46e5,color:#fff
```

## æ–¹å¼ä¸‰ï¼šJava æ–¹æ³•è¿”å›æ•°æ®

é€šè¿‡ `@InitDataList` æ³¨è§£æŒ‡å®š Java æ–¹æ³•è¿”å›çš„æ•°æ®é›†åˆã€‚

```mermaid
flowchart LR
    A["@InitDataList é™æ€æ–¹æ³•"] --> B["List"]
    B --> C["AutoTable æ’å…¥"]
    C --> D[("æ•°æ®åº“")]

    style A fill:#f59e0b,stroke:#d97706,color:#fff
    style C fill:#6366f1,stroke:#4f46e5,color:#fff
```

```java
@Data
@NoArgsConstructor
@AllArgsConstructor
@AutoTable(comment = "ç”¨ Java æ–¹æ³•åˆå§‹åŒ–æ•°æ®")
public class InitDataJavaMethod {

    private String name;

    @InitDataList
    public static List<InitDataJavaMethod> getInitData() {
        return Arrays.asList(
            new InitDataJavaMethod("å¼ ä¸‰"),
            new InitDataJavaMethod("æå››")
        );
    }

    @InitDataList
    private static List<InitDataJavaMethod> getMoreData() {
        return Arrays.asList(
            new InitDataJavaMethod("ç‹äº”"),
            new InitDataJavaMethod("èµµå…­")
        );
    }
}
```

::: warning æ³¨æ„äº‹é¡¹
1. å¿…é¡»æ˜¯**é™æ€æ–¹æ³•**
2. éœ€è¦ `@InitDataList` æ³¨è§£æ ‡æ³¨
3. è¿”å›å€¼å¿…é¡»æ˜¯ `List<Entity>`
4. è¯¥æ–¹æ³•åªèƒ½åœ¨å®ä½“ç±»ä¸­å®šä¹‰
:::

## æ‰§è¡Œæ—¶æœº

```mermaid
flowchart TD
    A["ğŸš€ åº”ç”¨å¯åŠ¨"] --> B["ğŸ“‹ æ‰«æå®ä½“"]
    B --> C{"è¡¨å­˜åœ¨?"}
    
    C -->|"å¦"| D["ğŸ“ CREATE TABLE"]
    D --> E["ğŸ“¦ æ‰§è¡Œåˆå§‹åŒ–"]
    
    C -->|"æ˜¯"| F["ğŸ” æ¯”å¯¹å·®å¼‚"]
    F --> G["âœï¸ ALTER TABLE"]
    
    E --> H["âœ… å®Œæˆ"]
    G --> H

    style D fill:#d1fae5,stroke:#10b981
    style E fill:#fef3c7,stroke:#f59e0b
```

**å…³é”®ç‚¹**ï¼š
- åˆå§‹åŒ–æ•°æ®åªåœ¨**è¡¨åˆ›å»ºæ—¶**æ‰§è¡Œä¸€æ¬¡
- è¡¨å·²å­˜åœ¨æ—¶ï¼Œ**ä¸ä¼š**é‡å¤æ‰§è¡Œ
- é€šè¿‡ç›‘å¬ `CreateTableFinishCallback` å›è°ƒè§¦å‘

## ä¸‹ä¸€æ­¥

- äº†è§£ [äº‹ä»¶å›è°ƒ](/é«˜çº§åŠŸèƒ½/äº‹ä»¶å›è°ƒ) æœºåˆ¶
- æŸ¥çœ‹ [é…ç½®é¡¹](/APIå‚è€ƒ/é…ç½®é¡¹) å®Œæ•´è¯´æ˜
