---
title: å·¥ä½œåŸç†
description: AutoTable æ¶æ„è®¾è®¡ä¸æ‰§è¡Œæµç¨‹
---

# å·¥ä½œåŸç†

## æ¶æ„æ¦‚è§ˆ

AutoTable é‡‡ç”¨ **ç­–ç•¥æ¨¡å¼ + SPI æœºåˆ¶** è®¾è®¡ï¼Œæ ¸å¿ƒæ¨¡å—èŒè´£æ¸…æ™°ï¼š

```mermaid
flowchart TB
    subgraph layer1["ğŸ”Œ æ¥å…¥å±‚"]
        direction LR
        SB["ğŸƒ Spring Boot Starter"]
        SO["â˜€ï¸ Solon Plugin"]
        JV["â˜• çº¯ Java API"]
    end

    subgraph layer2["âš™ï¸ æ ¸å¿ƒå±‚ AutoTable Core"]
        AN["ğŸ“ æ³¨è§£è§£æ"]
        MD["ğŸ—ï¸ å…ƒæ•°æ®æ„å»º"]
        ST["ğŸ¯ ç­–ç•¥è°ƒåº¦"]
        CB["ğŸ”” å›è°ƒæ‹¦æˆª"]
        AN --> MD --> ST --> CB
    end

    subgraph layer3["ğŸ“Š ç­–ç•¥å±‚ SPI"]
        direction LR
        MY["ğŸ¬ MySQL"]
        PG["ğŸ˜ PostgreSQL"]
        OR["ğŸ”¶ Oracle"]
        DM["ğŸ’  è¾¾æ¢¦"]
        MORE["â• ..."]
    end

    DB[("ğŸ’¾ Database")]

    SB & SO & JV --> layer2
    layer2 --> MY & PG & OR & DM & MORE
    MY & PG & OR & DM & MORE --> DB

    style layer1 fill:#dbeafe,stroke:#3b82f6,stroke-width:2px
    style layer2 fill:#fef3c7,stroke:#f59e0b,stroke-width:2px
    style layer3 fill:#d1fae5,stroke:#10b981,stroke-width:2px
    style DB fill:#fce7f3,stroke:#ec4899,stroke-width:2px
```

## æ¨¡å—è¯´æ˜

```mermaid
mindmap
  root((AutoTable))
    Core æ ¸å¿ƒ
      auto-table-core
        å¯åŠ¨å¼•æ“
        ç­–ç•¥è°ƒåº¦
        æ‹¦æˆªå™¨
      auto-table-annotation
        @AutoTable
        @AutoColumn
        @AutoIndex
    Strategy ç­–ç•¥
      MySQL
      PostgreSQL
      Oracle
      è¾¾æ¢¦/é‡‘ä»“
      H2/SQLite
    Integration é›†æˆ
      Spring Boot Starter
      Solon Plugin
      Mybatis-Plus Adapter
      Mybatis-Flex Adapter
```

## æ‰§è¡Œæµç¨‹

```mermaid
flowchart TD
    START(["ğŸš€ å¯åŠ¨"]) --> CHECK

    CHECK{"ğŸ” è¿è¡Œæ¨¡å¼?"}
    CHECK -->|"mode = none"| SKIP["â­ï¸ è·³è¿‡"]
    CHECK -->|"mode â‰  none"| INIT

    subgraph INIT["ğŸ“¦ åˆå§‹åŒ–"]
        direction TB
        SPI["1ï¸âƒ£ SPIåŠ è½½ç­–ç•¥"]
        SCAN["2ï¸âƒ£ æ‰«æå®ä½“"]
        GROUP["3ï¸âƒ£ æ•°æ®æºåˆ†ç»„"]
        DIALECT["4ï¸âƒ£ è¯†åˆ«æ–¹è¨€"]
        SPI --> SCAN --> GROUP --> DIALECT
    end

    INIT --> MODE

    MODE{"ğŸ¯ æ‰§è¡Œæ¨¡å¼"}
    
    MODE -->|"validate"| VAL
    MODE -->|"create"| CRE  
    MODE -->|"update"| UPD

    subgraph VAL["âœ… æ ¡éªŒæ¨¡å¼"]
        VAL_DO["æ¯”å¯¹ç»“æ„"]
        VAL_DO -->|"ä¸åŒ¹é…"| VAL_FAIL["âŒ å¤±è´¥"]
        VAL_DO -->|"åŒ¹é…"| VAL_OK["âœ“ é€šè¿‡"]
    end

    subgraph CRE["ğŸ”„ é‡å»ºæ¨¡å¼"]
        CRE_DROP["åˆ é™¤æ—§è¡¨"]
        CRE_NEW["åˆ›å»ºæ–°è¡¨"]
        CRE_DROP --> CRE_NEW
    end

    subgraph UPD["ğŸ“ æ›´æ–°æ¨¡å¼"]
        UPD_CHK{"è¡¨å­˜åœ¨?"}
        UPD_CHK -->|"å¦"| UPD_CREATE["åˆ›å»ºè¡¨"]
        UPD_CHK -->|"æ˜¯"| UPD_DIFF["æ¯”å¯¹å·®å¼‚"]
        UPD_DIFF --> UPD_ALTER["å¢é‡æ›´æ–°"]
    end

    CRE_NEW & UPD_CREATE & UPD_ALTER & VAL_OK --> EXEC

    subgraph EXEC["âš¡ æ‰§è¡Œ"]
        direction LR
        SQL["æ‰§è¡ŒSQL"]
        LOG["è®°å½•æ—¥å¿—"]
        CALL["è§¦å‘å›è°ƒ"]
        SQL --> LOG --> CALL
    end

    EXEC --> DONE(["âœ¨ å®Œæˆ"])

    style INIT fill:#eff6ff,stroke:#3b82f6
    style VAL fill:#ecfdf5,stroke:#10b981
    style CRE fill:#fef3c7,stroke:#f59e0b
    style UPD fill:#f0f9ff,stroke:#0ea5e9
    style EXEC fill:#fdf4ff,stroke:#d946ef
```

## ç­–ç•¥æ¨¡å¼

æ¯ç§æ•°æ®åº“éƒ½æœ‰å¯¹åº”çš„ç­–ç•¥å®ç°ï¼š

```mermaid
classDiagram
    direction TB
    
    class IStrategy {
        <<interface>>
        +databaseDialect() String
        +analyseClass(Class) TableMetadata
        +createTable(TableMetadata) List
        +compareTable(TableMetadata) CompareInfo
        +modifyTable(CompareInfo) List
    }
    
    class MysqlStrategy {
        +databaseDialect() MySQL
    }
    
    class PgsqlStrategy {
        +databaseDialect() PostgreSQL
    }
    
    class OracleStrategy {
        +databaseDialect() Oracle
    }
    
    class DMStrategy {
        +databaseDialect() DM
    }
    
    class H2Strategy {
        +databaseDialect() H2
    }
    
    class SqliteStrategy {
        +databaseDialect() SQLite
    }
    
    IStrategy <|.. MysqlStrategy
    IStrategy <|.. PgsqlStrategy
    IStrategy <|.. OracleStrategy
    IStrategy <|.. DMStrategy
    IStrategy <|.. H2Strategy
    IStrategy <|.. SqliteStrategy
```

**SPI é…ç½®æ–‡ä»¶ï¼š**

```
META-INF/services/org.dromara.autotable.core.strategy.IStrategy
```

## æ‹¦æˆªå™¨é“¾

```mermaid
flowchart LR
    subgraph interceptors["ğŸ”— æ‹¦æˆªå™¨é“¾"]
        direction LR
        I1["ğŸ·ï¸ Annotation"]
        I2["ğŸ—ï¸ Metadata"]
        I3["â• Create"]
        I4["âœï¸ Modify"]
        I1 --> I2 --> I3 --> I4
    end

    style I1 fill:#dbeafe,stroke:#3b82f6
    style I2 fill:#d1fae5,stroke:#10b981
    style I3 fill:#fef3c7,stroke:#f59e0b
    style I4 fill:#fce7f3,stroke:#ec4899
```

| æ‹¦æˆªå™¨ | è§¦å‘æ—¶æœº | ç”¨é€” |
|--------|----------|------|
| `AutoTableAnnotationInterceptor` | æ³¨è§£æ‰«æå‰ | ä¿®æ”¹æ‰«æçš„æ³¨è§£é›†åˆ |
| `BuildTableMetadataInterceptor` | å…ƒæ•°æ®æ„å»ºå | ä¿®æ”¹è¡¨å…ƒæ•°æ®ï¼ˆå¦‚å›½é™…åŒ–æ³¨é‡Šï¼‰ |
| `CreateTableInterceptor` | å»ºè¡¨å‰ | å»ºè¡¨å‰çš„è‡ªå®šä¹‰å¤„ç† |
| `ModifyTableInterceptor` | æ”¹è¡¨å‰ | æ”¹è¡¨å‰çš„è‡ªå®šä¹‰å¤„ç† |

## å›è°ƒäº‹ä»¶

```mermaid
flowchart LR
    subgraph lifecycle["ğŸ”” ç”Ÿå‘½å‘¨æœŸå›è°ƒ"]
        direction LR
        C1["ğŸš€ Ready"]
        C2["ğŸ—„ï¸ DBCreated"]
        C3["ğŸ“„ TableCreated"]
        C4["âœï¸ TableModified"]
        C5["ğŸ—‘ï¸ TableDeleted"]
        C6["âœ… Validated"]
        C7["ğŸ‰ Finished"]
        
        C1 --> C2 --> C3 --> C4 --> C5 --> C6 --> C7
    end

    style C1 fill:#dbeafe,stroke:#3b82f6
    style C2 fill:#d1fae5,stroke:#10b981
    style C3 fill:#d1fae5,stroke:#10b981
    style C4 fill:#fef3c7,stroke:#f59e0b
    style C5 fill:#fee2e2,stroke:#ef4444
    style C6 fill:#d1fae5,stroke:#10b981
    style C7 fill:#fce7f3,stroke:#ec4899
```

| å›è°ƒ | è§¦å‘æ—¶æœº |
|------|----------|
| `AutoTableReadyCallback` | å¯åŠ¨å‰ï¼Œé…ç½®å®Œæˆ |
| `CreateDatabaseFinishCallback` | æ•°æ®åº“åˆ›å»ºå |
| `CreateTableFinishCallback` | è¡¨åˆ›å»ºå |
| `ModifyTableFinishCallback` | è¡¨ä¿®æ”¹å |
| `DeleteTableFinishCallback` | è¡¨åˆ é™¤å |
| `ValidateFinishCallback` | æ ¡éªŒå®Œæˆå |
| `AutoTableFinishCallback` | å…¨éƒ¨æ‰§è¡Œå®Œæˆ |

## ä¸‹ä¸€æ­¥

- äº†è§£ [è¿è¡Œæ¨¡å¼](/æ ¸å¿ƒæ¦‚å¿µ/è¿è¡Œæ¨¡å¼) çš„é€‰æ‹©
- æŸ¥çœ‹ [æ‹¦æˆªå™¨](/é«˜çº§åŠŸèƒ½/æ‹¦æˆªå™¨) ä½¿ç”¨æ–¹æ³•
- å­¦ä¹  [è‡ªå®šä¹‰ç­–ç•¥](/é«˜çº§åŠŸèƒ½/è‡ªå®šä¹‰ç­–ç•¥) æ‰©å±•æ–°æ•°æ®åº“
