---
title: è¿è¡Œæ¨¡å¼
description: AutoTable å››ç§è¿è¡Œæ¨¡å¼è¯¦è§£
---

# è¿è¡Œæ¨¡å¼

AutoTable æä¾›å››ç§è¿è¡Œæ¨¡å¼ï¼Œé€‚ç”¨äºä¸åŒåœºæ™¯ã€‚

## æ¨¡å¼æ¦‚è§ˆ

```mermaid
flowchart LR
    subgraph modes["ğŸ¯ å››ç§è¿è¡Œæ¨¡å¼"]
        direction TB
        
        subgraph none["â¹ï¸ none"]
            N_DESC["å®Œå…¨ç¦ç”¨"]
        end
        
        subgraph validate["âœ… validate"]
            V_DESC["ä»…æ ¡éªŒç»“æ„"]
        end
        
        subgraph create["ğŸ”„ create"]
            C_DESC["åˆ è¡¨é‡å»º âš ï¸"]
        end
        
        subgraph update["ğŸ“ update"]
            U_DESC["å¢é‡æ›´æ–° ğŸŒŸ"]
        end
    end

    style none fill:#f3f4f6,stroke:#9ca3af
    style validate fill:#d1fae5,stroke:#10b981
    style create fill:#fee2e2,stroke:#ef4444
    style update fill:#dbeafe,stroke:#3b82f6
```

| æ¨¡å¼ | è¡Œä¸º | é€‚ç”¨åœºæ™¯ |
|------|------|----------|
| `none` | ä¸æ‰§è¡Œä»»ä½•æ“ä½œ | å®Œå…¨ç¦ç”¨ |
| `validate` | ä»…æ ¡éªŒï¼Œä¸ä¿®æ”¹ | **ç”Ÿäº§ç¯å¢ƒ** |
| `create` | åˆ è¡¨é‡å»º | æµ‹è¯•ç¯å¢ƒåˆå§‹åŒ– |
| `update` | å¢é‡æ›´æ–° | **å¼€å‘ç¯å¢ƒ**ï¼ˆé»˜è®¤ï¼‰ |

## æ¨¡å¼å¯¹æ¯”

```mermaid
flowchart TD
    START["ğŸš€ åº”ç”¨å¯åŠ¨"] --> CHECK{"è¡¨æ˜¯å¦å­˜åœ¨?"}
    
    CHECK -->|"none"| NONE["â¹ï¸ è·³è¿‡"]
    
    CHECK -->|"validate"| VAL_CHECK{"ç»“æ„ä¸€è‡´?"}
    VAL_CHECK -->|"âœ“"| VAL_OK["âœ… å¯åŠ¨æˆåŠŸ"]
    VAL_CHECK -->|"âœ—"| VAL_FAIL["âŒ å¯åŠ¨å¤±è´¥"]
    
    CHECK -->|"create"| CRE_DROP["ğŸ—‘ï¸ åˆ é™¤æ—§è¡¨"]
    CRE_DROP --> CRE_NEW["ğŸ“„ åˆ›å»ºæ–°è¡¨"]
    CRE_NEW --> CRE_OK["âœ… å¯åŠ¨æˆåŠŸ"]
    
    CHECK -->|"update"| UPD_CHECK{"è¡¨å­˜åœ¨?"}
    UPD_CHECK -->|"å¦"| UPD_CREATE["ğŸ“„ åˆ›å»ºè¡¨"]
    UPD_CHECK -->|"æ˜¯"| UPD_DIFF["ğŸ” æ¯”å¯¹å·®å¼‚"]
    UPD_DIFF --> UPD_ALTER["âœï¸ å¢é‡æ›´æ–°"]
    UPD_CREATE & UPD_ALTER --> UPD_OK["âœ… å¯åŠ¨æˆåŠŸ"]

    style NONE fill:#f3f4f6,stroke:#9ca3af
    style VAL_OK fill:#d1fae5,stroke:#10b981
    style VAL_FAIL fill:#fee2e2,stroke:#ef4444
    style CRE_DROP fill:#fef3c7,stroke:#f59e0b
    style CRE_NEW fill:#d1fae5,stroke:#10b981
    style CRE_OK fill:#d1fae5,stroke:#10b981
    style UPD_CREATE fill:#d1fae5,stroke:#10b981
    style UPD_ALTER fill:#dbeafe,stroke:#3b82f6
    style UPD_OK fill:#d1fae5,stroke:#10b981
```

## none æ¨¡å¼

```yaml
auto-table:
  mode: none
```

**è¡Œä¸º**ï¼šå®Œå…¨è·³è¿‡ AutoTable é€»è¾‘ï¼Œç­‰åŒäº `enable: false`ã€‚

**é€‚ç”¨åœºæ™¯**ï¼š
- ä¸´æ—¶ç¦ç”¨è‡ªåŠ¨å»ºè¡¨
- ç‰¹æ®Šç¯å¢ƒä¸éœ€è¦è¡¨ç»“æ„ç»´æŠ¤

## validate æ¨¡å¼

```yaml
auto-table:
  mode: validate
```

```mermaid
flowchart LR
    A["ğŸ“‹ è¯»å–å®ä½“"] --> B["ğŸ” æŸ¥è¯¢æ•°æ®åº“"]
    B --> C{"ç»“æ„ä¸€è‡´?"}
    C -->|"âœ“"| D["âœ… æ ¡éªŒé€šè¿‡"]
    C -->|"âœ—"| E["âŒ æŠ›å‡ºå¼‚å¸¸"]
    E --> F["ğŸ›‘ å¯åŠ¨å¤±è´¥"]

    style D fill:#d1fae5,stroke:#10b981
    style E fill:#fee2e2,stroke:#ef4444
    style F fill:#fee2e2,stroke:#ef4444
```

**è¡Œä¸º**ï¼š
1. æ£€æŸ¥æ•°æ®åº“ä¸­çš„è¡¨æ˜¯å¦å­˜åœ¨
2. æ¯”å¯¹è¡¨ç»“æ„ä¸å®ä½“å®šä¹‰æ˜¯å¦ä¸€è‡´
3. **ä¸ä¸€è‡´åˆ™å¯åŠ¨å¤±è´¥**ï¼ŒæŠ›å‡ºå¼‚å¸¸
4. ä¸æ‰§è¡Œä»»ä½• DDL è¯­å¥

**é€‚ç”¨åœºæ™¯**ï¼š
- âœ… **ç”Ÿäº§ç¯å¢ƒæ¨è**
- ç¡®ä¿ä»£ç ä¸æ•°æ®åº“ç»“æ„ä¸€è‡´
- åŠæ—©å‘ç°ç»“æ„ä¸åŒ¹é…é—®é¢˜

**ç¤ºä¾‹é”™è¯¯**ï¼š
```
å¯åŠ¨å¤±è´¥ï¼ŒMySQL æ•°æ®è¡¨ user ä¸å®ä½“ä¸åŒ¹é…ï¼š
- å­—æ®µ phone åœ¨å®ä½“ä¸­å­˜åœ¨ï¼Œä½†æ•°æ®åº“ä¸­ä¸å­˜åœ¨
- ç´¢å¼• auto_idx_email åœ¨å®ä½“ä¸­å­˜åœ¨ï¼Œä½†æ•°æ®åº“ä¸­ä¸å­˜åœ¨
```

## create æ¨¡å¼

```yaml
auto-table:
  mode: create
```

```mermaid
flowchart LR
    A["ğŸ—‘ï¸ DROP TABLE"] --> B["ğŸ“„ CREATE TABLE"]
    B --> C["âœ… å®Œæˆ"]

    style A fill:#fee2e2,stroke:#ef4444
    style B fill:#d1fae5,stroke:#10b981
    style C fill:#d1fae5,stroke:#10b981
```

**è¡Œä¸º**ï¼š
1. **åˆ é™¤**æ‰€æœ‰å®ä½“æ ‡æ³¨çš„è¡¨
2. æ ¹æ®å®ä½“å®šä¹‰**é‡æ–°åˆ›å»º**è¡¨

::: danger è­¦å‘Š
æ­¤æ¨¡å¼ä¼š**æ¸…ç©ºæ‰€æœ‰æ•°æ®**ï¼Œä»…ç”¨äºæµ‹è¯•ç¯å¢ƒï¼
:::

**é€‚ç”¨åœºæ™¯**ï¼š
- æµ‹è¯•ç¯å¢ƒåˆå§‹åŒ–
- éœ€è¦å¹²å‡€çš„è¡¨ç»“æ„
- è‡ªåŠ¨åŒ–æµ‹è¯•å‰ç½®å‡†å¤‡

## update æ¨¡å¼

```yaml
auto-table:
  mode: update
```

```mermaid
flowchart TD
    START["ğŸ” æ£€æµ‹è¡¨çŠ¶æ€"] --> CHECK{"è¡¨å­˜åœ¨?"}
    
    CHECK -->|"å¦"| CREATE["ğŸ“„ CREATE TABLE"]
    CHECK -->|"æ˜¯"| COMPARE["ğŸ“Š æ¯”å¯¹ç»“æ„"]
    
    COMPARE --> DIFF{"æœ‰å·®å¼‚?"}
    DIFF -->|"å¦"| SKIP["â­ï¸ è·³è¿‡"]
    DIFF -->|"æ˜¯"| ALTER["âœï¸ ALTER TABLE"]
    
    subgraph changes["ğŸ“ æ”¯æŒçš„å˜æ›´"]
        direction LR
        C1["â• æ–°å¢å­—æ®µ"]
        C2["âœï¸ ä¿®æ”¹å­—æ®µ"]
        C3["ğŸ”— æ–°å¢ç´¢å¼•"]
        C4["ğŸ’¬ æ›´æ–°æ³¨é‡Š"]
    end
    
    ALTER --> changes
    
    CREATE & SKIP & changes --> DONE["âœ… å®Œæˆ"]

    style CREATE fill:#d1fae5,stroke:#10b981
    style ALTER fill:#dbeafe,stroke:#3b82f6
    style changes fill:#f0f9ff,stroke:#0ea5e9
```

**é»˜è®¤è¡Œä¸º**ï¼š
- âœ… ä¼šæ–°å¢å­—æ®µ
- âœ… ä¼šä¿®æ”¹å­—æ®µå±æ€§
- âœ… ä¼šæ–°å¢ç´¢å¼•
- âŒ **ä¸ä¼šåˆ é™¤å­—æ®µ**ï¼ˆéœ€é…ç½® `auto-drop-column: true`ï¼‰
- âš ï¸ ä¼šåˆ é™¤æ¡†æ¶åˆ›å»ºçš„ç´¢å¼•ï¼ˆ`auto_idx_` å‰ç¼€ï¼‰

**é€‚ç”¨åœºæ™¯**ï¼š
- âœ… **å¼€å‘ç¯å¢ƒæ¨è**ï¼ˆé»˜è®¤æ¨¡å¼ï¼‰
- å¿«é€Ÿè¿­ä»£ï¼Œè‡ªåŠ¨åŒæ­¥è¡¨ç»“æ„

## ç¯å¢ƒé…ç½®å»ºè®®

```mermaid
flowchart LR
    subgraph dev["ğŸ› ï¸ å¼€å‘ç¯å¢ƒ"]
        D_MODE["mode: update"]
    end
    
    subgraph test["ğŸ§ª æµ‹è¯•ç¯å¢ƒ"]
        T_MODE["mode: create"]
    end
    
    subgraph prod["ğŸ­ ç”Ÿäº§ç¯å¢ƒ"]
        P_MODE["mode: validate"]
    end

    style dev fill:#dbeafe,stroke:#3b82f6
    style test fill:#fef3c7,stroke:#f59e0b
    style prod fill:#d1fae5,stroke:#10b981
```

### å¼€å‘ç¯å¢ƒ

```yaml
auto-table:
  mode: update
  show-banner: true
  auto-drop-column: false  # ä¸è‡ªåŠ¨åˆ é™¤å­—æ®µï¼Œé¿å…è¯¯åˆ 
```

### æµ‹è¯•ç¯å¢ƒ

```yaml
auto-table:
  mode: create  # æ¯æ¬¡å¯åŠ¨é‡å»ºè¡¨
```

### ç”Ÿäº§ç¯å¢ƒ

```yaml
auto-table:
  mode: validate  # ä»…æ ¡éªŒï¼Œä¸ä¿®æ”¹
  # æˆ–è€…å®Œå…¨ç¦ç”¨
  # enable: false
```

## å­—æ®µåˆ é™¤æ§åˆ¶

é»˜è®¤æƒ…å†µä¸‹ï¼Œ`update` æ¨¡å¼ä¸ä¼šåˆ é™¤å­—æ®µã€‚å¦‚éœ€è‡ªåŠ¨åˆ é™¤ï¼š

```yaml
auto-table:
  mode: update
  auto-drop-column: true  # å¼€å¯å­—æ®µåˆ é™¤
```

::: warning æ³¨æ„
å¼€å¯åï¼Œå®ä½“ä¸­ç§»é™¤çš„å­—æ®µä¼šä»æ•°æ®åº“åˆ é™¤ï¼Œ**æ•°æ®ä¸å¯æ¢å¤**ã€‚
å»ºè®®ä»…åœ¨å¼€å‘ç¯å¢ƒå¼€å¯ã€‚
:::

## ç´¢å¼•åˆ é™¤æ§åˆ¶

```yaml
auto-table:
  # åˆ é™¤æ¡†æ¶åˆ›å»ºçš„å¤šä½™ç´¢å¼•ï¼ˆauto_idx_ å‰ç¼€ï¼‰
  auto-drop-index: true  # é»˜è®¤ true
  
  # åˆ é™¤ç”¨æˆ·è‡ªå®šä¹‰çš„ç´¢å¼•ï¼ˆé auto_idx_ å‰ç¼€ï¼‰
  auto-drop-custom-index: false  # é»˜è®¤ false
```

## ä¸‹ä¸€æ­¥

- äº†è§£ [ç±»å‹æ˜ å°„](/æ ¸å¿ƒæ¦‚å¿µ/ç±»å‹æ˜ å°„) è§„åˆ™
- æŸ¥çœ‹å®Œæ•´ [é…ç½®é¡¹](/APIå‚è€ƒ/é…ç½®é¡¹)
- å­¦ä¹  [ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²](/æœ€ä½³å®è·µ/ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²) æœ€ä½³å®è·µ
